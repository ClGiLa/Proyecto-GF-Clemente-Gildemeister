---
title: "Proyecto Gestión Financiera"
author: "Clemente Gildemeister"
format: html
editor: visual
bibliography: references.bib
lang: es-CL
---

```{python}
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from datetime import timedelta
import yfinance as yf
from scipy.stats import norm
import mplfinance as mpf
```

# Hito 1:

## Descripción Activo y Contexto

Fecha de entrega límite: Miércoles 25 de Septiembre 23:59.

### Definición

Nvidia Corporation pertenece al sector tecnológico, con un enfoque clave en hardware y software para la inteligencia artificial (IA) y la computación gráfica. Este sector abarca el desarrollo y suministro de tecnologías avanzadas que permiten la creación, procesamiento y análisis de grandes cantidades de datos, habilitando la transformación digital en diversas industrias. Nvidia se destaca dentro del subgrupo de procesadores de alto rendimiento (GPUs) y computación acelerada, esenciales para el desarrollo de IA y aprendizaje automático.

En el ámbito académico, se han publicado varios estudios científicos que destacan el rol de Nvidia en la optimización del consumo de energía para entrenar modelos de aprendizaje automático. En particular, el artículo de García-Martín et al. (2021) analiza cómo las GPUs de Nvidia han reducido significativamente la cantidad de energía utilizada en estos procesos, permitiendo una mayor eficiencia y reduciendo la huella de carbono (Expansión). Este tipo de investigaciones científicas caracteriza y valida el impacto de Nvidia dentro del sector de la IA y su papel en la aceleración de tecnologías de próxima generación.

Además, el crecimiento de Nvidia en 2023 ha sido impulsado por la demanda global de infraestructura de IA, con sus procesadores siendo adoptados por gigantes tecnológicos como OpenAI y Google, lo que refuerza la relevancia del sector tecnológico en mercados como el S&P500 (El Sol de México) (El País).

```{python}
# Ticker de NVIDIA
ticker = "NVDA"

# Descargar datos históricos semanales para NVDA
data = yf.download(ticker, start="2020-01-01", end="2024-09-01", interval="1wk")
```

```{python NVDA Cierre historico}
# Configurar el gráfico
plt.figure(figsize=(20, 10))
plt.plot(data.index, data['Close'], label='Precio de Cierre')

plt.title('Precio de Cierre de NVDA')
plt.xlabel('Fecha')
plt.ylabel('Precio de Cierre')
plt.grid()
plt.legend()
plt.show()

```

```{python}
df = yf.download(ticker, start="2023-01-01", end="2024-09-01")
# Crear gráfico de velas
mpf.plot(df, type='candle', volume=False, title='Gráfico de Velas de NVDA', style='yahoo', ylabel='Precio', figsize=(14, 7))
```

### Motivación

Nvidia Corporation fue seleccionada por su papel clave en la innovación y desarrollo de tecnologías avanzadas de inteligencia artificial (IA), lo que la ha posicionado como un líder tecnológico indiscutible. Nvidia ha revolucionado la computación de alto rendimiento con su arquitectura CUDA y los Tensor Cores, que permiten el entrenamiento y la ejecución de modelos de IA mucho más grandes y complejos. Las aplicaciones de IA generativa como ChatGPT de OpenAI, que dependen de la capacidad de procesamiento masivo de las GPU de Nvidia, dependen de estos avances. (infobae)(El País).

Nvidia no solo ha liderado la innovación en IA, sino que también ha creado una infraestructura crucial para la expansión de la IA en sectores como los centros de datos, que son cruciales para empresas tecnológicas globales como Google, Microsoft y Meta. La plataforma Nvidia DGX ha sido fundamental para los modelos de aprendizaje profundo y el entrenamiento de redes neuronales, lo que ha permitido avances en campos importantes como la medicina, los vehículos autónomos y la robótica. Nvidia ha logrado posicionarse como la tercera empresa más valiosa en Estados Unidos gracias a su enfoque constante en el desarrollo de IA y computación acelerada, con una capitalización de mercado que supera los 2 billones de dólares (Expansión) (El Sol de México).

El estudio de García-Martín et al. (2021), que destaca cómo las GPUs de Nvidia mejoran el rendimiento computacional y optimizan el consumo de energía, lo cual es crucial para la IA sostenible, respalda la decisión de centrarse en Nvidia para este análisis. Nvidia se ha convertido en un actor importante en el futuro de la inteligencia artificial en todo el mundo gracias a los avances en la adopción de IA en sectores tradicionales y emergentes (El País).

### Contexto

Nvidia Corporation es uno de los principales actores del sector tecnológico en el S&P500, particularmente en el desarrollo de inteligencia artificial (IA) y procesadores gráficos (GPU). Nvidia se encuentra junto a líderes tecnológicos como Apple, Microsoft y Google en el Nasdaq. Para analizar las tendencias del sector y la posición competitiva de Nvidia, se presentan los precios históricos de Nvidia y sus principales rivales en el S&P500, como AMD e Intel: 

```{python}
# Lista de 10 empresas más grandes del S&P 500
sp500_top10 = ['AAPL', 'MSFT', 'GOOGL', 'AMZN', 'NVDA', 'BRK-B', 'META', 'TSLA', 'XOM', 'JNJ']

# Descargar datos históricos para las 10 empresas más grandes del S&P 500
data2 = yf.download(sp500_top10, start="2020-01-01", end="2024-09-01", interval="1wk", group_by='ticker')

# Asegúrate de que los índices de los DataFrames sean consistentes
data2 = data2.stack(level=0).rename_axis(['Date', 'Ticker']).reset_index()

# Gráfico de líneas para todos los tickers
plt.figure(figsize=(14, 7))

for ticker in sp500_top10:
    plt.plot(data2[data2['Ticker'] == ticker]['Date'], data2[data2['Ticker'] == ticker]['Close'], label=ticker)

plt.title('Precio de Cierre de las 10 Mejores Empresas del S&P 500')
plt.xlabel('Fecha')
plt.ylabel('Precio de Cierre (USD)')
plt.legend()
plt.grid()
plt.show()
```

Si bien los montos de los precios dependen de otros factores, tales como la cantidad de acciones que componen la compañía, si se observan tendencias entre estas. La más clara es que ambas empresas de Enel siguen un mismo patrón de precios, lo que hace sentido ya que pertenecen al mismo grupo. Lo que también se aprecia, es que cuando el precio de Enel aumenta, tanto de Engie Energia Chile S.A como el de AES Gener SA disminuye. Esto se puede deber a que la variación en la participación que tiene en la industria cada uno de estas influye inversamente en la otra (a mayor participación de Enel Chile, menor será la de el resto de los suministradores nacionales).

También es interesante ver las rentabilidades que ha tenido el activo elegido:

![](Data/Screenshot%202023-09-28%20at%2017.57.54.png){fig-align="center" width="144"}

A partir de esto se puede ver que Enel Chile ha tenido un crecimiento en la mayoría de los años, aunque se puede apreciar una baja de casi un 50% en el año 2021 debido a la pandemia de Covid-19. Cabe destacar que según analistas de Yahoo Finance, Enel Chile tendrá un crecimiento estimado cercano al 65,80%.

### Modelo Binomial

El Modelo Binomial de Valoración de Opciones (BM, por sus siglas en inglés) también conocido como Cox-Ross-Rubinstein introducido en @cox1979, es un modelo que estima el valor de una opción en t=0 teniendo pagos futuros en diferentes estados (usualmente "Up" y "Down"). Este Modelo Binomial asume que no hay posibilidad de arbitraje en el mercado, determinando el precio que sigue un activo en un random walk, en donde en cada paso (tiempo) existe una probabilidad de que el precio suba o baje (Ahmad, 2018).

![Random Walk en BM de un paso (Ahmad, 2018)](Data/Screenshot%202023-10-19%20at%2010.33.38.png){fig-align="center"}

Para calcular la valoración de la opción con el Modelo Binomial, es necesario definir $S_0$, que corresponde al precio actual del activo. Además, se deben determinar los valores de $u$ y $d$, que representan los factores por los cuales se multiplica $S_0$ en cada estado para obtener el precio del activo en cada caso en el siguiente período (t = 1):

$$
S_1 = \begin{cases}    S_0\cdot u \text{ en el estado ``Up"} \\    
S_0\cdot d \text{ en el estado ``Down"}\end{cases}
$$

También se debe calcular la probabilidad $P$ de que ocurra el caso "Up", la probabilidad de que ocurra el otro caso ("Down") simplemete quedaría en $(1-P)$. Para el calculo de la porobabilidad se usa la siguiente ecuación:

$$
P = \frac{e^r-d}{u-d}
$$

Donde $r$ es la tasa libre de riesgo.

Por otro lado se deben calcular $C_u$ y $C_d$ los cuales se obtienen como los precios de una opción europea:

$$
C_u = max(0, S_0\cdot u-k)\\
C_d = max(0, S_0\cdot d-k)
$$

Finalmente el precio de la opción se calcula de la siguiente manera:

$$
V = \frac{C_u\cdot P + C_d\cdot (1-P)}{1+r}
$$

```{python Calls con expiracion 2025-01-17}
opt_call = pd.read_csv('/cloud/project/Bases de Datos /Opciones_call_NVDA_Expiracion_2025-01-17.csv', delimiter=";")

S = data['Close'].iloc[-1]  # Precio actual del activo subyacente
T = 0.315708  # Tiempo hasta la expiración (en años)
K = opt_call[opt_call['inTheMoney'] == True].iloc[-1]
lp = K["lastPrice"]
K = K['strike'] # Precio de ejercicio de la opción
r = 0.0444  # Tasa de interés libre de riesgo T_Bill 17 week

print(f"Precio de ejercicio: {K}")
print(f"Ultimo precio: {lp}")


#https://home.treasury.gov/resource-center/data-chart-center/interest-rates/TextView?type=daily_treasury_bill_rates&field_tdr_date_value=2024
```

```{python}
# Modelo binomial
import math

rendimientos = np.diff(np.log(data['Close']))
sigma = np.std(rendimientos[1:])  # Volatilidad
diff = T/1

#u = 1 + sigma * math.sqrt(diff)  # Factor de crecimiento de un paso
#d = 1 - sigma * math.sqrt(diff)  # Factor de decrecimiento de un paso

u = 1.2
d = 0.9

# Calcular los valores
Su = S * u
Sd = S * d
p = (1 + r - d) / ((1 + r) * (u - d))

cu = max(Su - K, 0)
cd = max(Sd - K, 0)

# Calcular el precio de la opción
option_price = (cu * p + cd * (1 - p)) / (1 + r)

# Imprimir el resultado
print(f"El precio de la opción con el Modelo Binomial es: {option_price:.2f}")

```

### Modelo Black and Scholes (BS)

```{python}
import numpy as np
import pandas as pd
from scipy.stats import norm

# Definición de la función Black-Scholes
def black_scholes(S, K, t, r, sigma):
    d1 = (np.log(S / K) + (r + 0.5 * sigma**2) * t) / (sigma * np.sqrt(t))
    d2 = d1 - sigma * np.sqrt(t)
    N_d1 = norm.cdf(d1)
    N_d2 = norm.cdf(d2)
    precio_call = S * N_d1 - K * np.exp(-r * t) * N_d2
    return precio_call

# Calcular y mostrar el precio de la opción
precio_opcion = black_scholes(S, K, T, r, sigma)
print(f"El precio de la opción con el Modelo Black and Scholes es {precio_opcion:.2f}")

```

### Comparación de modelos

Ambos modelos son comúnmente utilizados en las finanzas. Por lo tanto, se puede afirmar que cuentan con respaldo y fundamentos sólidos. Según el artículo de (Ahmad, 2018), los resultados del precio de la opción calculados con ambos modelos muestran una correlación muy cercana a 1, lo que significa que si el precio de la opción aumenta con un modelo, también lo hace con el otro. Sin embargo, esto no implica que ambos modelos proporcionen el mismo precio, como se puede observar en el ejercicio realizado anteriormente.

Estos modelos difieren en algunas cosas, tales como:

-   Precio del activo subyacente: En modelo Black and Scholes sigue una distribución lognormal mientras que el Binomial multiplica el valos $S_0$ con dos opciones ($u$ y $d$)

-   Debido a lo anterior, el modelo de Black and Scholes es continuo y el Binomial discreto.

-   El modelo BS sirve solo para opciones europeas, mientras que el Binomial también sirve para opciones americanas.

También tienen algunas similitudes:

-   Ambos utilizan el precio actual del activo subyacente.

-   Ambos usan la tasa libre de riesgo.

-   En este caso los dos se usaron para un periodo de tiempo.

-   Ambos consideran la volatilidad del activo.

En resumen, el modelo de Black-Scholes constituye una buena herramienta analítica para valorar opciones europeas y supone movimientos continuos en las cotizaciones del mercado. En cambio, el modelo Binomial ofrece mayor flexibilidad al emplear una estructura de árbol que facilita la valoración tanto de opciones europeas como americanas. Elegir uno u otro modelo dependerá del tipo específico de opción que se esté analizando y las inferencias que se quieran hacer en relación a cómo evolucionarán los precios en el mercado financiero.

## Bibliografía
